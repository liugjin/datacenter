<div class="row nav-top"><div class="col s2"><nav>联动规则</nav></div><div class="col s10"><nav><div class="nav-wrapper"><ul class="right"><li><a title="新增" data-target="add-rule" ng-click="add()" href="#add-rule" class="modal-trigger"><i class="material-icons left">add</i>新增</a></li><li><a title="修改" data-target="add-rule" ng-click="modify()" href="" ng-show="re.notification" class="modal-trigger"><i class="material-icons left">edit</i>修改</a></li><li><a title="删除" data-target="prompt-modal" ng-click="delete()" ng-show="re.notification" class="modal-trigger"><i class="material-icons left">delete</i>删除</a></li></ul></div></nav></div></div><div class="row"><div class="col l12"><table><thead><tr><th>源设备</th><th>源告警</th><th>源告警状态</th><th>联动设备</th><th>联动动作</th><!--th 联动值--></tr></thead><tbody><tr ng-repeat="rule in rules" ng-click="select(rule)" ng-class="{active: re==rule,&quot;back-control&quot;: re==rule}"><td>{{rule.triggerEquip.station.model.name}}-{{rule.triggerEquip.model.name}}</td><td>{{rule.triggerEquip.events.getItemByIds({"event":rule.triggerAlarm}).model.name}}</td><td>{{project.dictionary.eventphases.getItemByIds({"phase":rule.triggerState}).model.name || "任意状态"}}</td><td>{{rule.linkEquip.station.model.name}}-{{rule.linkEquip.model.name}}</td><td>{{rule.linkEquip.commands.getItem(rule.linkAction).model.name}}</td></tr><!--td {{displayValue(rule)}}--></tbody></table></div></div><div id="add-rule" md-modal="md-modal" class="modal modal-fixed-footer"><div class="modal-content"><div style="height: 100%;" class="col s5 card no-box-shadow no-margin"><div class="card-title center">告警源</div><div class="card-content"><div class="input-field col s12"><i style="position:absolute;top:23%;left:6%" ng-show="!re.sourceEquipmentName" ng-click="listSourceEquipments()" class="material-icons">search</i><input id="source-equipment" type="search" ng-model="re.sourceEquipmentName" placeholder="        设备名称" ng-change="changeSourceEquipments()" class="autocomplete"/><i style="position:absolute;top:23%;" ng-click="listSourceEquipments()" class="material-icons">arrow_drop_down</i></div><!--.input-field.col.s12--><!--    label.active 源设备--><!--    select(ng-model='re.triggerDevice' md-select data='equipments')--><!--        option(ng-repeat='equip in equipments' value='{{equip.key}}' ng-selected='re.triggerDevice == equip.key') {{equip.station.model.name}}-{{equip.model.name}}--><div class="input-field col s12"><label class="active">源告警</label><select ng-model="re.triggerAlarm2" data="triggerAlarms2"><option ng-repeat="alarm in triggerAlarms" value="{{alarm.model.event}}" ng-selected="re.triggerAlarm2 == alarm.model.event">{{alarm.model.name}}</option></select></div><div class="input-field col s12"><label class="active">源告警状态</label><select ng-model="re.triggerState2" data="triggerStates"><option value="all">任意状态</option><option ng-repeat="state in triggerStates" value="{{state.model.phase}}" ng-selected="re.triggerState2 == state.model.phase">{{state.model.name}}</option></select></div></div></div><div class="col s2 center"><i class="material-icons white-text">forward</i></div><div style="height: 100%;" class="col s5 card no-box-shadow no-margin"><div class="card-title center">联动响应</div><div class="card-content"><div class="input-field col s12"><i style="position:absolute;top:23%;left:6%" ng-show="!re.linkEquipmentName" ng-click="listLinkEquipments()" class="material-icons">search</i><input id="link-equipment" type="search" ng-model="re.linkEquipmentName" placeholder="         设备名称" ng-change="changeLinkEquipments()" class="autocomplete"/><i style="position:absolute;top:23%;" ng-click="listLinkEquipments()" class="material-icons">arrow_drop_down</i></div><div class="input-field col s12"><label class="active">联动动作</label><select ng-model="re.linkAction2" md-select="md-select" data="linkActions"><option ng-repeat="action in linkActions" value="{{action.key}}" ng-selected="re.linkAction2 == action.key">{{action.model.name}}</option></select></div><div ng-repeat="parameter in re.cmdModelParameters" class="input-field col s12"><label class="active">命令参数： {{parameter.name || parameter.key}} (参数类型：{{parameter.type}})</label><input type="number" ng-model="parameter.value" ng-if="parameter.type=='int'" onkeydown="if(event.keyCode== 110 || event.keyCode== 190){return false;}" class="validate"/><input type="number" step="0.01" ng-model="parameter.value" ng-if="parameter.type=='float'" class="validate"/><input type="checkbox" ng-model="parameter.value" ng-if="parameter.type=='bool'"/><textarea ng-model="parameter.value" ng-if="parameter.type=='constant'" class="validate"></textarea><input type="text" ng-model="parameter.value" ng-if="parameter.type=='string'" class="validate"/><select ng-model="parameter.value" ng-if="parameter.type=='enum'"><option ng-repeat="kv in parameter.enums" value="{{kv.value}}" ng-selected="parameter.value==kv.value">{{kv.key}}</option></select></div></div></div></div><div class="modal-footer"><nav><div class="nav-wrapper"><ul><li><a ng-click="save()" ng-mouseenter="checkContent()" class="modal-action modal-close"><i class="material-icons left">save</i><span class="hide-on-med-and-down">保存</span></a></li><li class="right"><a class="modal-action modal-close"><i class="material-icons left">close</i><span class="hide-on-med-and-down">关闭</span></a></li></ul></div></nav></div></div><div id="prompt-modal" md-modal="md-modal" class="modal bottom-sheet2 modal-fixed-footer2"><div class="modal-content"><h5>{{promptModel.title}}</h5><p>{{promptModel.message}}</p><input type="text" ng-model="promptModel.comment" ng-show="promptModel.enableComment"/></div><div class="modal-footer"><a style="color: #fff" ng-click="promptModel.confirm(false)" class="modal-action modal-close waves-effect waves-green btn-flat">取消</a><a ng-click="promptModel.confirm(true)" class="modal-action modal-close waves-effect waves-green btn red">确认</a></div></div>