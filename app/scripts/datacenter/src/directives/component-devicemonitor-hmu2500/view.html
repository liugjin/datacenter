<div class="row"><div class="s12 m12 l12"><div id="equipment-tabs" class="nav-wrapper tabs-fixed-width tab-menu"><span><div ng-href="#overview" ng-click="setTab(&quot;overview&quot;)" ng-style="{&quot;background-color&quot;: tapFlag==&quot;overview&quot;?&quot;rgba(3,166,255,0.5)&quot;:&quot;&quot;}" class="btn standard-span-btn"><span>设备概览</span></div></span><span><div ng-href="#signals" ng-click="setTab(&quot;signals&quot;)" ng-style="{&quot;background-color&quot;: tapFlag==&quot;signals&quot;?&quot;rgba(3,166,255,0.5)&quot;:&quot;&quot;}" class="btn standard-span-btn"><span>实时数据</span></div></span><span><div ng-href="#events" ng-click="setTab(&quot;events&quot;)" ng-style="{&quot;background-color&quot;: tapFlag==&quot;events&quot;?&quot;rgba(3,166,255,0.5)&quot;:&quot;&quot;}" class="btn standard-span-btn"><span>事件告警</span></div></span><span><div ng-href="#commands" ng-click="setTab(&quot;commands&quot;)" ng-style="{&quot;background-color&quot;: tapFlag==&quot;commands&quot;?&quot;rgba(3,166,255,0.5)&quot;:&quot;&quot;}" class="btn standard-span-btn"><span>控制命令</span></div></span><span><div ng-href="#chart" ng-click="setTab(&quot;chart&quot;)" ng-style="{&quot;background-color&quot;: tapFlag==&quot;chart&quot;?&quot;rgba(3,166,255,0.5)&quot;:&quot;&quot;}" class="btn standard-span-btn"><span>图表分析</span></div></span></div><div id="overview" style="position: relative;" ng-show="tapFlag=='overview'"><graphicparamter-box controller="controller" parameters="{&quot;templateId&quot;:currEquipment.equipmentTemplate.model.graphic,&quot;templateParameters&quot;:{&quot;station&quot;:currEquipment.model.station,&quot;equipment&quot;:currEquipment.model.equipment},&quot;noBorderStyle&quot;: true}" class="graphic-height-equipment"></graphicparamter-box><div style="right: 1.45rem;bottom: 1.25rem;" class="fullscreen"><a ng-click="fullscreen(&quot;#graphicparamter&quot;)" title="全屏"><img src="res/svg/fullscreen.svg"/></a></div></div><div id="signals" ng-show="tapFlag == 'signals'"><div class="col row s12"><nav class="equiplannav z-depth-0"><div class="nav-wrapper"><div class="search-box"><i class="search-i material-icons">search</i><input type="search" ng-model="searchSignal" placeholder="输入信号ID或名称" required="required" class="search-signal-input"/><i ng-click="searchSignal = &quot;&quot;" ng-show="searchSignal" class="search-c material-icons">close</i></div></div></nav><div class="signal-list"><table class="hoverable highlight responsive-table"><thead><tr><th><div ng-click="currEquipment.signals.sortBy(&quot;data.severity&quot;)" class="col-header"><span>状态</span><span ng-show="currEquipment.signals.predicate == &quot;data.severity&quot;" class="right">{{currEquipment.signals.reverse && "▽" || "△"}}</span></div></th><th><!--.col-header(ng-click='currEquipment.signals.sortBy("model.name")')--><div class="col-header text-align-left"><span>信号名称</span><span ng-show="currEquipment.signals.predicate == &quot;model.name&quot;" class="right">{{currEquipment.signals.reverse && "▽" || "△"}}</span></div></th><th><!--.col-header(ng-click='currEquipment.signals.sortBy("data.value")')--><div class="col-header text-align-left"><span>实时值</span><span ng-show="currEquipment.signals.predicate == &quot;data.value&quot;" class="right">{{currEquipment.signals.reverse && "▽" || "△"}}</span></div></th><th><!--.col-header(ng-click='currEquipment.signals.sortBy("unit.unit")')--><div class="col-header text-align-left"><span>单位</span><span ng-show="currEquipment.signals.predicate == &quot;unit.unit&quot;" class="right">{{currEquipment.signals.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="currEquipment.signals.sortBy(&quot;data.timestamp&quot;)" class="col-header text-align-left"><span>更新时间</span><span ng-show="currEquipment.signals.predicate == &quot;data.timestamp&quot;" class="right">{{currEquipment.signals.reverse && "▽" || "△"}}</span></div></th><th><div class="text-align-left"><span>趋势图</span></div></th></tr></thead><tbody><!--tr(ng-repeat='signal in filterSignals = (currEquipment.signals.items | filter: currEquipment.signals.filter(searchSignal, ["signal", "name"], true)) | orderBy: currEquipment.signals.predicate: currEquipment.signals.reverse')--><tr ng-repeat="signal in filterSignals = (currEquipment.signals.items | filter: filterSignal()) | orderBy: currEquipment.signals.predicate:revers" ng-class="{&quot;active&quot;: signal == signal}"><td class="center"><a href="" data-target="signal-modal" ng-click="selectSignal(signal)" class="modal-trigger"><i ng-style="{color: signal.data.color || &quot;grey&quot;}" style="vertical-align: middle;" title="查看细节" class="material-icons">multitrack_audio</i></a></td><td class="center text-align-left">{{signal.instance.name}}</td><td class="center text-align-left"><span class="signal-value">{{signal.data.formatValue}}</span></td><td class="center text-align-left">{{signal.unit.unit}}</td><td class="center text-align-left">{{signal.data.timestamp | date: 'yyyy-MM-dd HH:mm:ss'}}</td><td class="center text-align-left"><a ng-click="signalTrend(signal)" title="信号趋势图" style="cursor: pointer;" ng-show="{{signal.model.dataType=='float'}}"><!--img(src="res/svg/fullscreen.svg")--><i class="material-icons small">trending_up</i></a></td></tr></tbody></table></div></div></div><div id="events" ng-show="tapFlag == 'events'"><style type="text/css">nav .input-field label {
    top: -11px;
    left: 0;
}
.input-field label:not(.label-icon).active {
    -webkit-transform: translateY(16px) scale(0.8);
    transform: translateY(16px) scale(0.8);
    -webkit-transform-origin: 0 0;
    transform-origin: 0 0;
}</style><div class="col row s12"><nav class="equiplannav z-depth-0"><div class="nav-wrapper"><div class="search-box"><i class="search-i material-icons">search</i><input type="search" ng-model="searchEvent" placeholder="输入事件ID或名称" required="required" class="search-signal-input"/><i ng-click="searchEvent = &quot;&quot;" ng-show="searchEvent" class="search-c material-icons">close</i></div></div></nav><div class="signal-list"><table class="hoverable highlight responsive-table"><thead><tr><th><div ng-click="currEquipment.events.sortBy(&quot;data.severity&quot;)" class="col-header"><span>状态</span><span ng-show="currEquipment.events.predicate == &quot;data.severity&quot;" class="right">{{currEquipment.events.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="currEquipment.events.sortBy(&quot;model.name&quot;)" class="col-header text-align-left"><span>事件名称</span><span ng-show="currEquipment.events.predicate == &quot;model.name&quot;" class="right">{{currEquipment.events.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="currEquipment.events.sortBy(&quot;data.title&quot;)" class="col-header text-align-left"><span>事件信息</span><span ng-show="currEquipment.events.predicate == &quot;data.title&quot;" class="right">{{currEquipment.events.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="currEquipment.events.sortBy(&quot;data.startValue&quot;)" class="col-header text-align-left"><span>开始值</span><span ng-show="currEquipment.events.predicate == &quot;data.startValue&quot;" class="right">{{currEquipment.events.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="currEquipment.events.sortBy(&quot;data.endValue&quot;)" class="col-header text-align-left"><span>结束值</span><span ng-show="currEquipment.events.predicate == &quot;data.endValue&quot;" class="right">{{currEquipment.events.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="currEquipment.events.sortBy(&quot;data.startTime&quot;)" class="col-header text-align-left"><span>开始时间</span><span ng-show="currEquipment.events.predicate == &quot;data.startTime&quot;" class="right">{{currEquipment.events.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="currEquipment.events.sortBy(&quot;data.endTime&quot;)" class="col-header text-align-left"><span>结束时间</span><span ng-show="currEquipment.events.predicate == &quot;data.endTime&quot;" class="right">{{currEquipment.events.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="currEquipment.events.sortBy(&quot;data.duration&quot;)" class="col-header text-align-left"><span>持续时长</span><span ng-show="currEquipment.events.predicate == &quot;data.duration&quot;" class="right">{{currEquipment.events.reverse && "▽" || "△"}}</span></div></th></tr></thead><tbody><tr ng-repeat="event in filterEvents = (currEquipment.events.items | filter: currEquipment.events.filter(searchEvent, [&quot;event&quot;, &quot;name&quot;], true)) | orderBy: currEquipment.events.predicate:revers" ng-class="{&quot;active&quot;: event == event}" ng-show="event.data.phase=='start'"><td class="center"><a href="" data-target="event-modal" ng-click="selectEvent(event)" class="waves-effect waves-light modal-trigger"><i ng-style="{color: event.data.color || &quot;grey&quot;}" title="查看细节" class="material-icons small">{{event.data.phase == "start" && "notifications_on" || event.data.phase == "confirm" && "notifications_paused" || event.data.phase == "end" && "notifications_off" || event.data.phase == "completed" && "notifications" || "notifications_none"}}</i></a></td><td class="text-align-left">{{event.instance.name}}</td><td class="text-align-left">{{event.data.title}}</td><td class="text-align-left">{{event.data.startValue}}</td><td class="text-align-left">{{event.data.endValue}}</td><td class="text-align-left">{{event.data.startTime | date: 'yyyy-MM-dd HH:mm:ss'}}</td><td class="text-align-left">{{event.data.endTime | date: 'yyyy-MM-dd HH:mm:ss'}}</td><td class="text-align-left"><span>{{event.data | duration}}</span><div title="{{event.data.progress}}" ng-style="{&quot;background-color&quot;: event.data.color?&quot;&quot;:&quot;transparent&quot;}" class="progress"><div ng-class="{}" ng-style="{width: event.data.progress, &quot;background-color&quot;: event.data.color}" class="determinate"></div></div></td></tr></tbody></table></div></div></div><div id="commands" ng-show="tapFlag == 'commands'"><div class="col row s12"><nav class="equiplannav z-depth-0"><div class="nav-wrapper"><div class="search-box"><i class="search-i material-icons">search</i><input type="search" ng-model="searchCommand" placeholder="输入控制ID或名称" required="required" class="search-signal-input"/><i ng-click="searchCommand = &quot;&quot;" ng-show="searchCommand" class="search-c material-icons">close</i></div></div></nav><div class="signal-list"><table class="hoverable highlight responsive-table"><thead><tr><th><div ng-click="currEquipment.commands.sortBy(&quot;data.phase&quot;)" class="col-header"><span>状态</span><span ng-show="currEquipment.commands.predicate == &quot;data.phase&quot;" class="pull-right">{{currEquipment.commands.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="currEquipment.commands.sortBy(&quot;name&quot;)" class="col-header text-align-left"><span>操作设置</span><span ng-show="currEquipment.commands.predicate == &quot;name&quot;" class="pull-right">{{currEquipment.commands.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="currEquipment.commands.sortBy(&quot;data.parameters&quot;)" class="col-header text-align-left"><span>当前目标状态</span><span ng-show="currEquipment.commands.predicate == &quot;data.parameters&quot;" class="pull-right">{{currEquipment.commands.reverse && "▽" || "△"}}</span></div></th><th><div class="text-align-left"><span>目标状态</span></div></th><th><div ng-click="currEquipment.commands.sortBy(&quot;data.startTime&quot;)" class="col-header text-align-left"><span>控制时间</span><span ng-show="currEquipment.commands.predicate == &quot;data.startTime&quot;" class="pull-right">{{currEquipment.commands.reverse && "▽" || "△"}}</span></div></th><th></th></tr></thead><tbody><tr ng-repeat="command in filterCommands = (currEquipment.commands.items | filter: currEquipment.commands.filter(searchCommand, [&quot;command&quot;, &quot;name&quot;], true))" ng-class="{&quot;active&quot;: command == command}"><td title="{{command.data.phase}}" class="center"><a href="" data-target="command-modal" ng-click="selectCommand(command)" class="waves-effect waves-light modal-trigger"><i title="查看细节" class="material-icons small">{{!command.data && "share" || command.data.phase == "executing" && "send" || command.data.phase == "timeout" && "access_time" || command.data.phase == "complete" && "done" || command.data.phase == "cancel" && "not_interested" || command.data.phase == "error" && "error" || "send"}}</i></a><div ng-show="command.data.phase == &quot;executing&quot;" class="progress"><div title="查看细节" class="indeterminate"></div></div></td><td class="text-align-left">{{command.instance.name}}</td><td class="text-align-left">{{command.data.parameters3.slice(6)}}</td><td class="text-align-left"><div ng-repeat="parameter in command.model.parameters" ng-switch="parameter.type"><div ng-switch-when="int" class="input-field col s12"><input type="number" step="1" ng-model="parameter.value" placeholder="输入设置值" class="validate"/></div><div ng-switch-when="float" class="input-field col s12"><input type="number" step="any" ng-model="parameter.value" placeholder="输入设置值" class="validate"/></div><div ng-switch-when="bool" class="input-field col s12"><p><input type="checkbox" id="p-{{parameter.key}}" ng-model="parameter.value"/><label for="p-{{parameter.key}}"></label></p></div><div ng-switch-when="enum" class="input-field col s12"><select ng-model="parameter.value" md-select="md-select" data="parameter"><option ng-repeat="kv in parameter.enums" value="{{kv.value}}" ng-selected="parameter.value == kv.value">{{kv.key}}</option></select></div><div ng-switch-when="content" placeholder="输入设置值" class="input-field col s12"><textarea ng-model="parameter.value" class="validate"></textarea></div><div ng-switch-when="command" class="input-field col s12"><input type="text" ng-model="parameter.value" placeholder="输入设置值" class="validate"/></div><div ng-switch-default="ng-switch-default" class="input-field col s12"><input type="text" ng-model="parameter.value" placeholder="输入设置值" class="validate"/></div></div></td><td class="text-align-left">{{command.data.endTime | date: 'yyyy-MM-dd HH:mm:ss'}}</td><td><a data-target="command-execution-modal" ng-click="selectCommand(command)" title="{{command.data.phase}}" class="btn waves-effect waves-light modal-trigger"><span class="hide-on-med-and-down">{{command.data.phase == "executing" && "取消控制" || "执行控制"}}</span></a></td></tr></tbody></table></div></div></div><div id="chart" ng-show="tapFlag== 'chart'"><equip-lineorbar-hmu2500 controller="controller" parameters="{&quot;station&quot;:currEquipment.model.station,&quot;equipment&quot;:currEquipment.model.equipment, width: &quot;52vw&quot;}"></equip-lineorbar-hmu2500></div></div></div><div id="equipment-modal" md-modal="md-modal" class="modal bottom-sheet modal-fixed-footer"><div class="modal-content"><div class="row"><div class="col s12 m6 l4"><div class="input-field col s12"><input id="equipment" type="text" ng-model="vm.equipment.model.equipment" ng-disabled="vm.equipment.model._id" class="validate"/><label for="equipment" ng-class="{active: vm.equipment.model.equipment}">设备ID</label></div><div class="input-field col s12"><input id="name" type="text" ng-model="vm.equipment.model.name" class="validate"/><label for="name" ng-class="{active: vm.equipment.model.name}">设备名称</label></div><div class="input-field col s10"><label class="active">设备类型</label><select ng-model="vm.equipment.model.type" md-select="md-select" data="vm.equipment.model"><option value="">未知设备类型</option><option ng-repeat="type in vm.project.typeModels.equipmenttypes.items" value="{{type.model.type}}" ng-selected="vm.equipment.model.type == type.model.type">{{type.model.name}}</option></select></div><div class="col s2"><div class="reference-img"><a style="color:#00a856;" ng-href="{{vm.setting.services.model}}/#/equipmenttypes/{{vm.equipment.model.user}}/{{vm.equipment.model.project}}?type={{vm.equipment.model.type}}" target="_blank" title="查看设备类型"><img ng-if="vm.project.typeModels.equipmenttypes.keys[vm.equipment.model.type].image" ng-src="{{vm.options.uploadUrl}}/{{vm.project.typeModels.equipmenttypes.keys[vm.equipment.model.type].image}}" class="img-responsive"/><i ng-if="!vm.project.typeModels.equipmenttypes.keys[vm.equipment.model.type].image" class="material-icons small">link</i></a></div></div><div class="input-field col s10"><label class="active">设备厂商</label><select ng-model="vm.equipment.model.vendor" md-select="md-select" data="vm.equipment.model"><option value="">未知设备厂商</option><option ng-repeat="vendor in vm.project.typeModels.vendors.items" value="{{vendor.model.vendor}}" ng-selected="vm.equipment.model.vendor == vendor.model.vendor">{{vendor.model.name}}</option></select></div><div class="col s2"><div class="reference-img"><a style="color:#00a856;" ng-href="{{vm.setting.services.model}}/#/vendors/{{vm.equipment.model.user}}/{{vm.equipment.model.project}}?vendor={{vm.equipment.model.vendor}}" target="_blank" title="查看设备厂商"><img ng-if="vm.project.typeModels.vendors.keys[vm.equipment.model.vendor].image" ng-src="{{vm.options.uploadUrl}}/{{vm.project.typeModels.vendors.keys[vm.equipment.model.vendor].image}}" class="img-responsive"/><i ng-if="!vm.project.typeModels.vendors.keys[vm.equipment.model.vendor].image" class="material-icons small">link</i></a></div></div><div class="input-field col s10"><label class="active">设备模板</label><select ng-model="vm.equipment.model.template" md-select="md-select" data="vm.equipment.model.type + &quot;.&quot; + vm.equipment.model.vendor"><option value="">未知设备模板</option><option ng-repeat="template in vm.equipmentTemplates | filter: vm.filterEquipmentTemplate()" value="{{template.model.template}}" ng-selected="vm.equipment.model.template == template.model.template">{{template.model.name}}</option></select></div><div class="col s2"><div class="reference-img"><a style="color:#00a856;" ng-href="{{vm.setting.services.model}}/#/equipmenttemplates/{{vm.equipment.model.user}}/{{vm.equipment.model.project}}/{{vm.equipment.model.type}}?template={{vm.equipment.model.template}}" target="_blank" title="查看设备模板"><img ng-if="vm.project.typeModels.equipmentTemplates.keys[vm.equipment.model.type + &quot;.&quot; + vm.equipment.model.template].image" ng-src="{{vm.options.uploadUrl}}/{{vm.project.typeModels.equipmentTemplates.keys[vm.equipment.model.type + &quot;.&quot; + vm.equipment.model.template].image}}" class="img-responsive"/><i ng-if="!vm.project.typeModels.equipmentTemplates.keys[vm.equipment.model.type + &quot;.&quot; + vm.equipment.model.template].image" class="material-icons small">link</i></a></div></div><div class="input-field col s12"><input type="text" ng-model="vm.equipment.model.parent" class="validate"/><label ng-class="{active: vm.equipment.model.parent}">上级设备</label></div><div class="input-field col s12"><input type="text" ng-model="vm.equipment.model.group" class="validate"/><label ng-class="{active: vm.equipment.model.group}">分组</label></div><div class="input-field col s10"><label class="active">责任人</label><select ng-model="vm.equipment.model.owner" md-select="md-select" data="vm.equipment.model"><option value="">未知责任人</option><option ng-repeat="user in vm.project.model.starUsers" value="{{user.user}}" ng-selected="vm.equipment.model.owner == user.user">{{user.userName}}</option></select></div><div class="input-field col s12"><input type="text" ng-model="vm.equipment.model.graphic" class="validate"/><label ng-class="{active: vm.equipment.model.graphic}">组态模板</label></div><div class="switch col s12 l6"><label>无效<input type="checkbox" ng-model="vm.equipment.model.enable"/><span class="lever"></span>有效</label></div><div class="input-field col s12"><textarea id="desc" ng-model="vm.equipment.model.desc" class="materialize-textarea validate"></textarea><label for="desc" ng-class="{active: vm.equipment.model.desc}">描述</label></div></div><div class="col s12 m6 l4"><div class="property-grid"><table class="hoverable responsive-table highlight"><thead><tr><th>扩展属性</th><th>赋值</th><th>单位</th></tr></thead><tbody><!--tr(ng-repeat='property in vm.equipment.properties.items | orderBy: "model.index"')--><tr ng-repeat="property in vm.equipment.properties.items | filter: vm.equipment.properties.filter(vm.searchProperty, [&quot;property&quot;, &quot;name&quot;], true) | orderBy: vm.equipment.properties.predicate: vm.equipment.properties.reverse"><td><div class="input-field col s12"><label class="active">属性 ({{property.model.property}})</label><p class="grey-text">{{property.model.name}}</p></div></td><td ng-switch="property.model.dataType"><div ng-switch-default="ng-switch-default" class="input-field col s12"><input type="text" ng-model="property.value" class="validate"/><label ng-class="{active: property.value}">属性值</label></div><div ng-switch-when="enum" class="input-field col s12"><label class="active">枚举值</label><select ng-model="property.value" md-select="md-select" data="property.model.dataType"><option ng-repeat="map in property.model._format" value="{{map.value}}" ng-selected="property.value == map.value">{{map.name}}</option></select></div><div ng-switch-when="int" class="input-field col s12"><input type="number" ng-model="property.value" min="{{property.model._format.min}}" max="{{property.model._format.max}}" step="any" class="validate"/><label ng-class="{active: property.value}">整数值</label></div><div ng-switch-when="float" class="input-field col s12"><input type="number" ng-model="property.value" min="{{property.model._format.min}}" max="{{property.model._format.max}}" step="any" class="validate"/><label ng-class="{active: property.value}">浮点数</label></div><div ng-switch-when="color" class="input-field col s12"><input type="text" ng-model="property.value" class="validate"/><label ng-class="{active: property.value}">颜色</label><input type="color" ng-model="property.value" class="validate"/></div><div ng-switch-when="password" class="input-field col s12"><input type="password" ng-model="property.value" class="validate"/><label ng-class="{active: property.value}">密码</label></div><div ng-switch-when="date" class="input-field col s12"><i class="material-icons prefix">today</i><input type="date" input-format="input-format" ng-model="property.value" class="validate"/><label class="active">日期</label></div><div ng-switch-when="time" class="input-field col s12"><i class="material-icons prefix">access_time</i><input type="time" ng-model="property.value" class="validate"/><label class="active">时间</label></div><div ng-switch-when="datetime" class="input-field col s12"><i class="material-icons prefix">today</i><input type="datetime-local" input-format="input-format" ng-model="property.value" class="validate"/><label class="active">日期时间</label></div><div ng-switch-when="json" class="input-field col s12"><textarea ng-model="property.value" class="materialize-textarea validate"></textarea><label ng-class="{active: property.value}">JSON</label></div><div ng-switch-when="html" class="input-field col s12"><textarea ng-model="property.value" class="materialize-textarea validate"></textarea><label ng-class="{active: property.value}">HTML</label></div><div ng-switch-when="script" class="input-field col s12"><textarea ng-model="property.value" class="materialize-textarea validate"></textarea><label ng-class="{active: property.value}">SCRIPT</label></div><div ng-switch-when="bool" class="col s12 property-checkbox"><input type="checkbox" ng-model="property.value" id="cb-{{property.model.property}}"/><label for="cb-{{property.model.property}}">有效</label></div><div ng-switch-when="image" class="col s12"><label>上载图片</label><div class="img-uploader"><image-uploader ng-model="property.value" dir="{{vm.options.uploadUrl}}"></image-uploader></div></div><div ng-switch-when="file" class="col s12"><label>上载文件</label><div class="file-uploader"><file-uploader ng-model="property.value" dir="{{vm.options.fileUrl}}"></file-uploader></div></div></td><td><div class="input-field col s12"><label ng-if="property.model.unit" class="active">单位</label><p>{{vm.project.typeModels.units.getItem(property.model.unit).model.abbr || property.model.unit}}</p></div></td></tr></tbody></table></div></div><div class="col s12 m6 l4"><div class="row"><label>上载图片</label><div class="img-uploader model-img-upload"><image-uploader ng-model="vm.equipment.model.image" dir="{{vm.options.uploadUrl}}"></image-uploader></div></div><div class="row"><!--strong 采集单元设置--><div class="property-grid"><table class="hoverable responsive-table highlight"><thead><tr><th>采集单元</th><th>类型</th><th>绑定值</th></tr></thead><tbody><tr ng-repeat="sampleUnit in vm.equipment.sampleUnits"><td><label>{{sampleUnit.name}} ({{sampleUnit.id}})</label></td><td><label>{{sampleUnit.type}}</label></td><td><input type="text" ng-model="sampleUnit.value" placeholder="MonitoringUnit/SampleUnit" class="validate"/></td></tr></tbody></table></div><!--.property-gridtable.hoverable.responsive-table
    thead
        tr
            //-th(width='20%') ID
            th(width='30%') 名称
            th(width='20%') 类型
            th(width='*') 绑定值
    tbody
        tr(ng-repeat='sampleUnit in vm.equipment.sampleUnits')
            //-td
                .input-field.col.s12
                    //-input.validate(type='text', ng-model='sampleUnit.id', disabled)
                    label(ng-class='{active: sampleUnit.id}') ID
                    p {{sampleUnit.id}}
            td
                .input-field.col.s12
                    //-input.validate(type='text', ng-model='sampleUnit.name', disabled)
                    label(ng-class='{active: sampleUnit.name}') 名称 ({{sampleUnit.id}})
                    p {{sampleUnit.name}}
            td
                .input-field.col.s12
                    //-input.validate(type='text', ng-model='sampleUnit.type', disabled)
                    label(ng-class='{active: sampleUnit.type}') 类型
                    p {{sampleUnit.type}}
            td
                .input-field.col.s12
                    input.validate(type='text', ng-model='sampleUnit.value')
                    label(ng-class='{active: sampleUnit.value}') 绑定值

--></div></div></div></div><div class="modal-footer modal-nav"><nav ng-class="mvm.setting.theme"><div class="nav-wrapper"><ul><li><a href="" ng-click="vm.saveEquipment()" title="保存设备"><i class="material-icons left">save</i><span class="hide-on-med-and-down">保存</span></a></li><li ng-show="vm.equipment.model._id"><a href="" ng-click="vm.removeEquipment()" title="删除设备"><i class="material-icons left">delete</i><span class="hide-on-med-and-down">删除</span></a></li><li><a href="" ng-click="vm.createEquipment()" title="增加新设备"><i class="material-icons left">add</i><span class="hide-on-med-and-down">增加</span></a></li><!--li(ng-show='vm.station.model._id')--><!--    a(ng-href='{{vm.setting.services.model}}/#/equipments/{{vm.equipment.model.user}}/{{vm.equipment.model.project}}/{{vm.equipment.model.station}}/{{vm.equipment.model.equipment}}/edit', title='详细配置', target='_blank')--><!--        i.material-icons.left settings--><!--        span.hide-on-med-and-down 配置--><li><a title="现场管理"><i class="material-icons left">trending_up</i><span class="hide-on-med-and-down">监控</span></a></li><li ng-show="vm.equipment.model.type == &quot;rack&quot;"><a ng-href="#/rack-plan/{{vm.equipment.model.user}}/{{vm.equipment.model.project}}?station={{vm.equipment.model.station}}&amp;equipment={{vm.equipment.model.equipment}}" title="机架管理"><i class="material-icons left">vibration</i><span class="hide-on-med-and-down">机架</span></a></li><li ng-show="vm.equipment.model.type == &quot;server&quot; &amp;&amp; vm.equipment.model.parent"><a ng-href="#/rack-plan/{{vm.equipment.model.user}}/{{vm.equipment.model.project}}?station={{vm.equipment.model.station}}&amp;equipment={{vm.equipment.model.parent}}" title="机架管理"><i class="material-icons left">vibration</i><span class="hide-on-med-and-down">机架</span></a></li><li><a href="" ng-click="vm.selectNext()" title="选择上一资产" class="waves-effect waves-light"><i class="material-icons left">arrow_upward</i><span class="hide-on-med-and-down">上移</span></a></li><li><a href="" ng-click="vm.selectPrevious()" title="选择下一资产" class="waves-effect waves-light"><i class="material-icons left">arrow_downward</i><span class="hide-on-med-and-down">下移</span></a></li><ul class="right"><li><div class="input-field"><input id="searchProperty" type="search" placeholder="属性搜索" ng-model="vm.searchProperty" class="search-input"/><label for="searchProperty" class="label-icon"><i class="material-icons">search</i></label><i ng-click="vm.searchProperty = &quot;&quot;" ng-show="vm.searchProperty" class="material-icons">close</i></div></li><li><a href="" class="modal-action modal-close"><i class="material-icons right">close</i><span class="hide-on-med-and-down">关闭</span></a></li></ul></ul></div></nav></div></div><style>i {
    vertical-align: middle;
}</style><div id="signal-modal" md-modal="md-modal" style="max-height: 55%;" class="modal bottom-sheet modal-fixed-footer"><div class="modal-content"><div class="row"><div class="col s12 m6 l4"><p class="equipment-item-title">{{signal.station.model.name}} / {{signal.equipment.model.name}} / {{signal.instance.name}}</p><table class="hoverable responsive-table highlight"><tbody><tr><td style="width: 15%;"><label>信号ID</label></td><td><span>{{signal.model.signal}}</span></td><td class="center"><!--a(ng-href='{{setting.services.model}}/#/equipmentsignals/{{signal.model.user}}/{{signal.model.project}}/{{signal.model.type}}/{{signal.model.template}}?signal={{signal.model.signal}}', target='_blank', title='模板信号配置')--><!--    i.material-icons settings--></td></tr><tr><td><label>信号名称</label></td><td><input type="text" ng-model="signal.instance.name" style="border-top: 0 !important;border-left: 0 !important;border-right: 0 !important;border-bottom: 0 !important;margin-bottom: 0 !important;" class="validate"/></td><td></td></tr><tr><td><label>信号使能</label></td><td><div class="switch"><label>无效<input type="checkbox" ng-model="signal.instance.enable"/><span class="lever"></span>有效</label></div></td><td></td></tr><tr><td><label>信号状态</label></td><td><span>{{signal.data.tooltip}}</span></td><td class="center"><i ng-style="{color: signal.data.color}" title="{{signal.data.tooltip}}" class="material-icons">multitrack_audio</i></td></tr><tr><td><label>实时值</label></td><td><span>{{signal.data.newFormatValue}}</span></td><td class="center"><span>{{signal.unit.unit}}</span></td></tr><tr ng-repeat="statistic in signal.statistics"><td><label>统计/{{statisticNames[statistic.mode] || statistic.mode}}</label></td><td title="统计最小值/平均值/最大值"><span>{{statistic.min | number:2}} / {{statistic.avg | number:2}} / {{statistic.max | number:2}}</span></td><td title="统计周期"><label>{{statistic.period}}</label></td></tr><tr><td><label>变化时间</label></td><td><span>{{signal.data.timestamp | date: 'yyyy-MM-dd HH:mm:ss'}}</span></td><td></td></tr></tbody></table></div><div ng-show="signal.model.dataType == &quot;float&quot; " class="col s12 m6 l8"><signal-chart signals="signalValues" setting="signalSetting" data="signalValue" class="signal-chart"></signal-chart></div><div class="col s12 m6 l8"><div class="row"><div class="right"><label>数据时段: {{signalManager.parameters.startTime.format('YYYY-MM-DD HH:mm:ss')}} ~ {{signalManager.parameters.endTime.format('YYYY-MM-DD HH:mm:ss')}}</label><label>&nbsp;/&nbsp;查询时间：</label><label am-time-ago="signalManager.parameters.queryTime"></label><label>&nbsp;/&nbsp;记录数：{{signalManager.records.items.length}}</label></div></div><div class="row"><table class="bordered responsive-table hoverable highlight"><thead><tr><th><div ng-click="signalManager.records.sortBy(&quot;severity&quot;)" class="col-header"><span>级别</span><span ng-show="signalManager.records.predicate == &quot;severity&quot;" class="pull-right">{{signalManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="signalManager.records.sortBy(&quot;index&quot;)" class="col-header"><span>索引</span><span ng-show="signalManager.records.predicate == &quot;index&quot;" class="pull-right">{{signalManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="signalManager.records.sortBy(&quot;value&quot;)" class="col-header"><span>信号值</span><span ng-show="signalManager.records.predicate == &quot;value&quot;" class="pull-right">{{signalManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="signalManager.records.sortBy(&quot;unit&quot;)" class="col-header"><span>单位</span><span ng-show="signalManager.records.predicate == &quot;endValue&quot;" class="pull-right">{{signalManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="signalManager.records.sortBy(&quot;mode&quot;)" class="col-header"><span>存储类型</span><span ng-show="signalManager.records.predicate == &quot;mode&quot;" class="pull-right">{{signalManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="signalManager.records.sortBy(&quot;timestamp&quot;)" class="col-header"><span>记录时间</span><span ng-show="signalManager.records.predicate == &quot;timestamp&quot;" class="pull-right">{{signalManager.records.reverse && "▽" || "△"}}</span></div></th></tr></thead><tbody><tr ng-repeat="signal in signalManager.records.items | orderBy: signalManager.records.predicate:signalManager.records.reverse | limitTo: signalManager.records.pageItems * signalManager.records.page | limitTo: -signalManager.records.pageItems"><td style="text-align: center;"><i ng-style="{color: signal.color || &quot;#00a856&quot;}" title="{{signal.eventSeverity.name || &quot;正常&quot;}}" class="material-icons">multitrack_audio</i></td><td style="text-align: center;">{{signal._index}}</td><!--td {{signal.name}}--><td style="text-align: center;">{{signal.value | prettyNumber:2}}</td><td style="text-align: center;">{{signal.unitName}}</td><td style="text-align: center;">{{signal.modeName}}</td><td style="text-align: center;">{{signal.timestamp| date:'yyyy-MM-dd HH:mm:ss'}}</td></tr></tbody></table><ul ng-show="signalManager.parameters.paging.pages.length &gt; 1" class="pagination"><li ng-class="{disabled: signalManager.parameters.paging.page &lt;= 1, &quot;waves-effect&quot;: signalManager.parameters.paging.page &gt; 1}" ng-click="signalManager.queryPage(&quot;previous&quot;)"><a href=""><i class="material-icons">chevron_left</i></a></li><li ng-class="{active: page == signalManager.parameters.paging.page, &quot;waves-effect&quot;: page != signalManager.parameters.paging.page}" ng-repeat="page in signalManager.parameters.paging.pages" ng-click="signalManager.queryPage(page)"><a href="">{{page}}</a></li><li ng-class="{disabled: signalManager.parameters.paging.page &gt;= signalManager.parameters.paging.pageCount, &quot;waves-effect&quot;: signalManager.parameters.paging.page &lt; signalManager.parameters.paging.pageCount}" ng-click="signalManager.queryPage(&quot;next&quot;)"><a href=""><i class="material-icons">chevron_right</i></a></li></ul></div></div></div></div><div class="modal-footer modal-nav"><nav ng-class="msetting.theme"><div class="nav-wrapper"><ul><li><a href="" ng-click="saveSignalInstance(signal)" title="保持信号实例信息"><i class="material-icons left">save</i><span class="hide-on-med-and-down">保存</span></a></li><li><a href="" ng-click="selectNextSignal()" title="选择上一信号" class="waves-effect waves-light"><i class="material-icons left">arrow_upward</i><span class="hide-on-med-and-down">上移</span></a></li><li><a href="" ng-click="selectPreviousSignal()" title="选择下一信号" class="waves-effect waves-light"><i class="material-icons left">arrow_downward</i><span class="hide-on-med-and-down">下移</span></a></li><ul class="right"><li><a href="" data-target="signal-query-periods" data-hover="true" data-beloworigin="false" md-dropdown="md-dropdown" title="报表查询时段" class="dropdown-trigger">{{signalManager.recordType.name || "报表查询时段"}}<i class="material-icons right">arrow_drop_up</i></a></li><li><a href="" title="上移查询时段" ng-click="signalManager.queryRecords(signal, &quot;previous&quot;)"><i class="material-icons left">skip_previous</i><span class="hide-on-med-and-down">前移</span></a></li><li><a href="" title="查询数据" ng-click="signalManager.queryRecords(signal, &quot;refresh&quot;)"><i class="material-icons left">refresh</i><span class="hide-on-med-and-down">查询</span></a></li><li><a href="" title="下移查询时段" ng-click="signalManager.queryRecords(signal, &quot;next&quot;)"><i class="material-icons left">skip_next</i><span class="hide-on-med-and-down">后移</span></a></li><li><a href="" class="modal-action modal-close"><i class="material-icons left">close</i><span class="hide-on-med-and-down">关闭</span></a></li></ul></ul></div></nav><ul id="signal-query-periods" class="dropdown-content"><li ng-repeat="type in signalManager.recordTypes"><a href="" ng-class="{active: type == signalManager.recordType}" ng-click="signalManager.selectRecordType(type); signalManager.queryRecords(signal)">{{type.name}}</a></li></ul></div></div><div id="event-modal" md-modal="md-modal" class="modal bottom-sheet modal-fixed-footer"><div class="modal-content"><div class="row"><div class="col s12 m6 l4"><p class="equipment-item-title">{{event.station.model.name}} / {{event.equipment.model.name}} / {{event.instance.name}}</p><table class="hoverable responsive-table highlight"><tbody><tr><td><label>告警ID</label></td><td><span>{{event.model.event}}</span></td><td class="center"><!--a(ng-href='{{setting.services.model}}/#/equipmentevents/{{event.model.user}}/{{event.model.project}}/{{event.model.type}}/{{event.model.template}}?event={{event.model.event}}', target='_blank', title='模板告警配置')--><!--    i.material-icons.huayuancolor settings--></td></tr><tr><td><label>告警名称</label></td><td><input type="text" ng-model="event.instance.name" style="border-top: 0 !important;border-left: 0 !important;border-right: 0 !important;border-bottom: 0 !important;margin-bottom: 0 !important;"/></td><td></td></tr><tr><td><label>告警使能</label></td><td><div class="switch"><label>无效<input type="checkbox" ng-model="event.instance.enable"/><span class="lever"></span>有效</label></div></td><td></td></tr><tr><td><label>告警描述</label></td><td><span>{{event.data.title}}</span></td><td></td></tr><tr><td><label>设备类型</label></td><td><span>{{event.data.equipmentType}}</span></td><td></td></tr><tr><td><label>设备模板</label></td><td><span>{{event.data.equipmentTemplate}}</span></td><td></td></tr><tr><td><label>告警状态</label></td><td><span>{{event.data.eventSeverity.name}}</span></td><td class="center"><i ng-style="{color: event.data.color}" title="{{event.data.eventSeverity.name}}" class="material-icons small">{{event.data.phase == "start" && "notifications_on" || event.data.phase == "confirm" && "notifications_paused" || event.data.phase == "end" && "notifications_off" || event.data.phase == "completed" && "notifications" || "notifications_none"}}</i></td></tr><tr><td><label>触发值</label></td><td><span>{{event.data.startValue}}</span></td><td></td></tr><tr><td><label>结束值</label></td><td><span>{{event.data.endValue}}</span></td><td></td></tr><tr><td><label>开始时间</label></td><td><span>{{event.data.startTime | date: 'yyyy-MM-dd HH:mm:ss'}}</span></td><td></td></tr><tr><td><label>结束时间</label></td><td><span>{{event.data.endTime | date: 'yyyy-MM-dd HH:mm:ss'}}</span></td><td></td></tr><tr><td><label>持续时长</label></td><!--tdspan {{event.data.duration}}--><td><span>{{event.data | duration}}</span><div title="{{event.data.progress}}" class="progress"><div ng-class="{}" ng-style="{width: event.data.progress, &quot;background-color&quot;: event.data.color}" class="determinate"></div></div></td><td></td></tr><tr><td><label>备注</label></td><td><span>{{event.data.comment}}</span></td><td></td></tr><tr><td><label>确认时间</label></td><td><span>{{event.data.confirmTime | date: 'yyyy-MM-dd HH:mm:ss'}}</span></td><td></td></tr><tr><td><label>确认人</label></td><td><span>{{event.data.operator}}</span></td><td></td></tr></tbody></table></div><div class="col s12 m6 l8"><div class="row"><div class="right"><label>数据时段: {{eventManager.parameters.startTime.format('YYYY-MM-DD HH:mm:ss')}} ~ {{eventManager.parameters.endTime.format('YYYY-MM-DD HH:mm:ss')}}</label><label>&nbsp;/&nbsp;查询时间：</label><label am-time-ago="eventManager.parameters.queryTime"></label><label>&nbsp;/&nbsp;记录数：{{eventManager.records.items.length}}</label></div></div><div class="row"><table class="bordered responsive-table hoverable highlight"><thead><tr><th><div ng-click="eventManager.records.sortBy(&quot;severity&quot;)" class="col-header"><span>级别</span><span ng-show="eventManager.records.predicate == &quot;severity&quot;" class="pull-right">{{eventManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="eventManager.records.sortBy(&quot;index&quot;)" class="col-header"><span>#</span><span ng-show="eventManager.records.predicate == &quot;index&quot;" class="pull-right">{{eventManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="eventManager.records.sortBy(&quot;title&quot;)" class="col-header"><span>告警名称</span><span ng-show="eventManager.records.predicate == &quot;title&quot;" class="pull-right">{{eventManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="eventManager.records.sortBy(&quot;startValue&quot;)" class="col-header"><span>开始值</span><span ng-show="eventManager.records.predicate == &quot;startValue&quot;" class="pull-right">{{eventManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="eventManager.records.sortBy(&quot;endValue&quot;)" class="col-header"><span>结束值</span><span ng-show="eventManager.records.predicate == &quot;endValue&quot;" class="pull-right">{{eventManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="eventManager.records.sortBy(&quot;startTime&quot;)" class="col-header"><span>开始时间</span><span ng-show="eventManager.records.predicate == &quot;startTime&quot;" class="pull-right">{{eventManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="eventManager.records.sortBy(&quot;endTime&quot;)" class="col-header"><span>结束时间</span><span ng-show="eventManager.records.predicate == &quot;endTime&quot;" class="pull-right">{{eventManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="eventManager.records.sortBy(&quot;duration&quot;)" title="持续时长管理目标不超过1个小时" class="col-header"><span>持续时长</span><span ng-show="eventManager.records.predicate == &quot;duration&quot;" class="pull-right">{{eventManager.records.reverse && "▽" || "△"}}</span></div></th></tr></thead><tbody><tr ng-repeat="event in eventManager.records.items | orderBy: eventManager.records.predicate:eventManager.records.reverse | limitTo: eventManager.records.pageItems * eventManager.records.page | limitTo: -eventManager.records.pageItems"><td><i ng-style="{color: event.color}" title="{{event.eventSeverity.name}}" class="material-icons small">{{event.phase == "start" && "notifications_on" || event.phase == "confirm" && "notifications_paused" || event.phase == "end" && "notifications_off" || event.phase == "completed" && "notifications" || "notifications_none"}}</i></td><td>{{event._index}}</td><td>{{event.title || event.event}}</td><td>{{event.startValue | prettyNumber:2}}</td><td>{{event.endValue | prettyNumber:2}}</td><td>{{event.startTime| date:'yyyy-MM-dd HH:mm:ss'}}</td><td>{{event.endTime| date:'yyyy-MM-dd HH:mm:ss'}}</td><td><span>{{event | duration}}</span><!--.progress(title="{{event.progress}}").determinate(ng-class='{}', ng-style='{width: event.progress, "background-color": event.color}')--></td></tr></tbody></table><ul ng-show="eventManager.parameters.paging.pages.length &gt; 1" class="pagination"><li ng-class="{disabled: eventManager.parameters.paging.page &lt;= 1, &quot;waves-effect&quot;: eventManager.parameters.paging.page &gt; 1}" ng-click="eventManager.queryPage(&quot;previous&quot;)"><a href=""><i class="material-icons">chevron_left</i></a></li><li ng-class="{active: page == eventManager.parameters.paging.page, &quot;waves-effect&quot;: page != eventManager.parameters.paging.page}" ng-repeat="page in eventManager.parameters.paging.pages" ng-click="eventManager.queryPage(page)"><a href="">{{page}}</a></li><li ng-class="{disabled: eventManager.parameters.paging.page &gt;= eventManager.parameters.paging.pageCount, &quot;waves-effect&quot;: eventManager.parameters.paging.page &lt; eventManager.parameters.paging.pageCount}" ng-click="eventManager.queryPage(&quot;next&quot;)"><a href=""><i class="material-icons">chevron_right</i></a></li></ul></div></div></div></div><div class="modal-footer modal-nav"><nav ng-class="msetting.theme"><div class="nav-wrapper"><ul><li><a href="" ng-click="saveEventInstance(event)" title="保存告警实例"><i class="material-icons left">save</i><span class="hide-on-med-and-down">保存</span></a></li><li><a href="" ng-click="confirmEquipmentEvent(event)" title="确认当前告警"><i class="material-icons left">done</i><span class="hide-on-med-and-down">确认</span></a></li><li><a href="" ng-click="confirmEquipmentEvent(event, true)" title="强制结束告警"><i class="material-icons left">check_circle</i><span class="hide-on-med-and-down">结束</span></a></li><li><a href="" ng-click="confirmEquipmentEvents(currEquipment)" title="确认设备所有告警"><i class="material-icons left">done_all</i><span class="hide-on-med-and-down">设备</span></a></li><li><a ng-href="#/event-manager/{{event.model.user}}/{{event.model.project}}?station={{event.station.model.station}}&amp;equipment={{event.equipment.model.equipment}}&amp;event={{event.model.event}}" title="集中告警管理"><i class="material-icons left">notifications_none</i><span class="hide-on-med-and-down">管理</span></a></li><li><a href="" ng-click="selectNextEvent()" title="选择上一事件" class="waves-effect waves-light"><i class="material-icons left">arrow_upward</i><span class="hide-on-med-and-down">上移</span></a></li><li><a href="" ng-click="selectPreviousEvent()" title="选择下一事件" class="waves-effect waves-light"><i class="material-icons left">arrow_downward</i><span class="hide-on-med-and-down">下移</span></a></li><ul class="right"><li><a href="" data-target="event-query-periods" data-hover="true" data-beloworigin="false" md-dropdown="md-dropdown" title="报表查询时段" class="dropdown-trigger">{{eventManager.recordType.name || "报表查询时段"}}<i class="material-icons right">arrow_drop_up</i></a></li><li><a href="" title="上移查询时段" ng-click="eventManager.queryRecords(event, &quot;previous&quot;)"><i class="material-icons left">skip_previous</i><span class="hide-on-med-and-down">前移</span></a></li><li><a href="" title="查询数据" ng-click="eventManager.queryRecords(event, &quot;refresh&quot;)"><i class="material-icons left">refresh</i><span class="hide-on-med-and-down">查询</span></a></li><li><a href="" title="下移查询时段" ng-click="eventManager.queryRecords(event, &quot;next&quot;)"><i class="material-icons left">skip_next</i><span class="hide-on-med-and-down">后移</span></a></li><li><a href="" class="modal-action modal-close"><i class="material-icons left">close</i><span class="hide-on-med-and-down">关闭</span></a></li></ul></ul></div></nav><ul id="event-query-periods" class="dropdown-content"><li ng-repeat="type in eventManager.recordTypes"><a href="" ng-class="{active: type == eventManager.recordType}" ng-click="eventManager.selectRecordType(type); eventManager.queryRecords(event)">{{type.name}}</a></li></ul></div></div><div id="command-modal" md-modal="md-modal" class="modal bottom-sheet modal-fixed-footer"><div class="modal-content"><div class="row"><div class="col s12 m6 l3"><p class="equipment-item-title">{{command.station.model.name}} / {{command.equipment.model.name}} / {{command.instance.name}}</p><table class="hoverable responsive-table highlight"><tbody><tr><td><label>控制ID</label></td><td><span>{{command.model.command}}</span></td><td><!--a(ng-href='{{setting.services.model}}/#/equipmentcommands/{{command.model.user}}/{{command.model.project}}/{{command.model.type}}/{{command.model.template}}?command={{command.model.command}}', target='_blank', title='模板控制配置')--><!--    i.material-icons settings--></td></tr><tr><td><label>控制名称</label></td><td><input type="text" ng-model="command.instance.name" style="border-top: 0 !important;border-left: 0 !important;border-right: 0 !important;border-bottom: 0 !important;margin-bottom: 0 !important;"/></td><td></td></tr><tr><td><label>控制使能</label></td><td><div class="switch"><label>无效<input type="checkbox" ng-model="command.instance.enable"/><span class="lever"></span>有效</label></div></td><td></td></tr><tr><td><span>控制参数</span></td><td colspan="2"><div ng-repeat="parameter in command.model.parameters" ng-switch="parameter.type"><div ng-switch-when="int" class="input-field col s12"><input type="number" step="1" ng-model="parameter.value" class="validate"/><label class="active">{{parameter.name}} ({{parameter.key}})</label></div><div ng-switch-when="float" class="input-field col s12"><input type="number" step="any" ng-model="parameter.value" class="validate"/><label class="active">{{parameter.name}} ({{parameter.key}})</label></div><div ng-switch-when="bool" class="input-field col s12"><p><input type="checkbox" id="p-{{parameter.key}}" ng-model="parameter.value"/><label for="p-{{parameter.key}}"></label></p></div><div ng-switch-when="enum" class="input-field col s12"><label class="active">{{parameter.name}} ({{parameter.key}})</label><select ng-model="parameter.value" md-select="md-select" data="parameter"><option ng-repeat="kv in parameter.enums" value="{{kv.value}}" ng-selected="parameter.value == kv.value">{{kv.key}}</option></select></div><div ng-switch-when="content" class="input-field col s12"><textarea ng-model="parameter.value" class="validate"></textarea><label class="active">{{parameter.name}} ({{parameter.key}})</label></div><div ng-switch-when="command" class="input-field col s12"><input type="text" ng-model="parameter.value" class="validate"/><label class="active">{{parameter.name}} ({{parameter.key}})</label></div><div ng-switch-default="ng-switch-default" class="input-field col s12"><input type="text" ng-model="parameter.value" class="validate"/><label class="active">{{parameter.name}} ({{parameter.key}})</label></div></div></td></tr><tr><td><span>控制备注</span></td><td colspan="2"><div class="input-field col s12"><input type="text" ng-model="command.model.comment" class="validate"/><label ng-class="{active: command.model.comment}">执行备注</label></div></td></tr></tbody></table></div><div class="col s12 m6 l9"><div class="row"><div class="right"><label>数据时段: {{commandManager.parameters.startTime.format('YYYY-MM-DD HH:mm:ss')}} ~ {{commandManager.parameters.endTime.format('YYYY-MM-DD HH:mm:ss')}}</label><label>&nbsp;/&nbsp;查询时间：</label><label am-time-ago="commandManager.parameters.queryTime"></label><label>&nbsp;/&nbsp;记录数：{{commandManager.records.items.length}}</label></div></div><div class="row"><table class="bordered hoverable responsive-table highlight"><thead><tr><th><div ng-click="commandManager.records.sortBy(&quot;phase&quot;)" class="col-header"><span>状态</span><span ng-show="commandManager.records.predicate == &quot;phase&quot;" class="pull-right">{{commandManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="commandManager.records.sortBy(&quot;_index&quot;)" class="col-header"><span>索引</span><span ng-show="commandManager.records.predicate == &quot;_index&quot;" class="pull-right">{{commandManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="commandManager.records.sortBy(&quot;startTime&quot;)" class="col-header"><span>执行时间</span><span ng-show="commandManager.records.predicate == &quot;startTime&quot;" class="pull-right">{{commandManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="commandManager.records.sortBy(&quot;endTime&quot;)" class="col-header"><span>完成时间</span><span ng-show="commandManager.records.predicate == &quot;endTime&quot;" class="pull-right">{{commandManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="commandManager.records.sortBy(&quot;parameters&quot;)" class="col-header"><span>控制参数</span><span ng-show="commandManager.records.predicate == &quot;parameters&quot;" class="pull-right">{{commandManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="commandManager.records.sortBy(&quot;priority&quot;)" class="col-header"><span>优先级</span><span ng-show="commandManager.records.predicate == &quot;priority&quot;" class="pull-right">{{commandManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="commandManager.records.sortBy(&quot;result&quot;)" class="col-header"><span>控制结果</span><span ng-show="commandManager.records.predicate == &quot;result&quot;" class="pull-right">{{commandManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="commandManager.records.sortBy(&quot;comment&quot;)" class="col-header"><span>执行备注</span><span ng-show="commandManager.records.predicate == &quot;comment&quot;" class="pull-right">{{commandManager.records.reverse && "▽" || "△"}}</span></div></th><th><div ng-click="commandManager.records.sortBy(&quot;triggerName&quot;)" class="col-header"><span>操作人员</span><span ng-show="commandManager.records.predicate == &quot;triggerName&quot;" class="pull-right">{{commandManager.records.reverse && "▽" || "△"}}</span></div></th></tr></thead><tbody><tr ng-repeat="command in commandManager.records.items | orderBy: commandManager.records.predicate:commandManager.records.reverse | limitTo: commandManager.records.pageItems * commandManager.records.page | limitTo: -commandManager.records.pageItems"><td title="{{command.phase}}"><i class="material-icons small">{{command.phase == "executing" && "send" || command.phase == "timeout" && "access_time" || command.phase == "complete" && "done" || command.phase == "cancel" && "not_interested" || command.phase == "error" && "error" || "share"}}</i><div ng-show="command.phase == &quot;executing&quot;" class="progress"><div class="indeterminate"></div></div></td><td><span>{{command._index}}</span></td><!--tdspan {{command.name}}--><td><span>{{command.startTime | date: 'yyyy-MM-dd HH:mm:ss'}}</span></td><td><span>{{command.endTime| date: 'yyyy-MM-dd HH:mm:ss'}}</span></td><td><span>{{command.parameters3}}</span></td><td><span>{{command.priority}}</span></td><td><span>{{command.result}}</span></td><td><span>{{command.comment}}</span></td><td><span>{{command.triggerName}}</span></td></tr></tbody></table><ul ng-show="commandManager.parameters.paging.pages.length &gt; 1" class="pagination"><li ng-class="{disabled: commandManager.parameters.paging.page &lt;= 1, &quot;waves-effect&quot;: commandManager.parameters.paging.page &gt; 1}" ng-click="commandManager.queryPage(&quot;previous&quot;)"><a href=""><i class="material-icons">chevron_left</i></a></li><li ng-class="{active: page == commandManager.parameters.paging.page, &quot;waves-effect&quot;: page != commandManager.parameters.paging.page}" ng-repeat="page in commandManager.parameters.paging.pages" ng-click="commandManager.queryPage(page)"><a href="">{{page}}</a></li><li ng-class="{disabled: commandManager.parameters.paging.page &gt;= commandManager.parameters.paging.pageCount, &quot;waves-effect&quot;: commandManager.parameters.paging.page &lt; commandManager.parameters.paging.pageCount}" ng-click="commandManager.queryPage(&quot;next&quot;)"><a href=""><i class="material-icons">chevron_right</i></a></li></ul></div></div></div></div><div class="modal-footer modal-nav"><nav ng-class="mvm.setting.theme"><div class="nav-wrapper"><ul><li><a href="" ng-click="saveCommandInstance(command)" title="保持控制实例信息"><i class="material-icons left">save</i><span class="hide-on-med-and-down">保存</span></a></li><li><a href="" data-target="command-execution-modal" title="执行控制命令" ng-show="command.data.phase != &quot;executing&quot;" class="waves-effect waves-light modal-trigger"><i class="material-icons left">send</i><span class="hide-on-med-and-down">执行控制</span></a><a href="" data-target="command-execution-modal" title="取消控制命令" ng-show="command.data.phase == &quot;executing&quot;" class="waves-effect waves-light modal-trigger"><i class="material-icons left">cancel</i><span class="hide-on-med-and-down">取消控制</span></a></li><li><a href="" ng-click="selectNextCommand()" title="选择上一控制" class="waves-effect waves-light"><i class="material-icons left">arrow_upward</i><span class="hide-on-med-and-down">上移</span></a></li><li><a href="" ng-click="selectPreviousCommand()" title="选择下一控制" class="waves-effect waves-light"><i class="material-icons left">arrow_downward</i><span class="hide-on-med-and-down">下移</span></a></li><ul class="right"><li><a href="" data-target="command-query-periods" data-hover="true" data-beloworigin="false" md-dropdown="md-dropdown" title="报表查询时段" class="dropdown-trigger">{{commandManager.recordType.name || "报表查询时段"}}<i class="material-icons right">arrow_drop_up</i></a></li><li><a href="" title="上移查询时段" ng-click="commandManager.queryRecords(command, &quot;previous&quot;)"><i class="material-icons left">skip_previous</i><span class="hide-on-med-and-down">前移</span></a></li><li><a href="" title="查询数据" ng-click="commandManager.queryRecords(command, &quot;refresh&quot;)"><i class="material-icons left">refresh</i><span class="hide-on-med-and-down">查询</span></a></li><li><a href="" title="下移查询时段" ng-click="commandManager.queryRecords(command, &quot;next&quot;)"><i class="material-icons left">skip_next</i><span class="hide-on-med-and-down">后移</span></a></li><li><a href="" class="modal-action modal-close"><i class="material-icons left">close</i><span class="hide-on-med-and-down">关闭</span></a></li></ul></ul></div></nav><ul id="command-query-periods" class="dropdown-content"><li ng-repeat="type in commandManager.recordTypes"><a href="" ng-class="{active: type == commandManager.recordType}" ng-click="commandManager.selectRecordType(type); commandManager.queryRecords(command)">{{type.name}}</a></li></ul></div></div><style>.input-field>label:not(.label-icon).active {
    transform: translateY(-14px) scale(0.8);
    transform-origin: 0 0;
}</style><div id="command-execution-modal" md-modal="md-modal" class="modal bottom-sheet2 modal-fixed-footer"><div class="modal-content"><div class="row"><div class="col s12"><p class="equipment-item-title">{{command.station.model.name}} / {{command.equipment.model.name}} / {{command.instance.name}}</p></div><div class="col s6"><table class="hoverable responsive-table highlight"><tbody><tr><td><label>控制ID</label></td><td><span>{{command.model.command}}</span></td><td><!--a(ng-href='{{setting.services.model}}/#/equipmentcommands/{{command.model.user}}/{{command.model.project}}/{{command.model.type}}/{{command.model.template}}?command={{command.model.command}}', target='_blank', title='模板控制配置')--><!--    i.material-icons settings--></td></tr><tr><td><label>控制优先级</label></td><td><span>{{command.model.priority}}</span></td><td></td></tr><tr><td><label>控制超时</label></td><td><span>{{command.model.timeout}}</span></td><td><label>毫秒</label></td></tr><tr><td><label>控制权限</label></td><td><span>{{command.model.password && "密码验证" || "简单"}}</span></td><td></td></tr><tr><td><label>控制状态</label></td><td><i class="material-icons small">{{!command.data && "share" || command.data.phase == "executing" && "send" || command.data.phase == "timeout" && "access_time" || command.data.phase == "complete" && "done" || command.data.phase == "cancel" && "not_interested" || command.data.phase == "error" && "error" || "send"}}</i><div ng-show="command.data.phase == &quot;executing&quot;" class="progress"><div class="indeterminate"></div></div></td><td><span>{{command.data.phase}}</span></td></tr></tbody></table></div><div class="col s6"><div ng-repeat="parameter in command.model.parameters" ng-switch="parameter.type"><div ng-switch-when="int" class="input-field col s12"><input type="number" step="1" ng-model="parameter.value" class="validate"/><label class="active">{{parameter.name}} ({{parameter.key}})</label></div><div ng-switch-when="float" class="input-field col s12"><input type="number" step="any" ng-model="parameter.value" class="validate"/><label class="active">{{parameter.name}} ({{parameter.key}})</label></div><div ng-switch-when="bool" class="input-field col s12"><p><input type="checkbox" id="p-{{parameter.key}}" ng-model="parameter.value"/><label for="p-{{parameter.key}}"></label></p></div><div ng-switch-when="enum" class="input-field col s12"><label class="active">{{parameter.name}} ({{parameter.key}})</label><select ng-model="parameter.value" md-select="md-select" data="parameter"><option ng-repeat="kv in parameter.enums" value="{{kv.value}}" ng-selected="parameter.value == kv.value">{{kv.key}}</option></select></div><div ng-switch-when="content" class="input-field col s12"><textarea ng-model="parameter.value" class="validate"></textarea><label class="active">{{parameter.name}} ({{parameter.key}})</label></div><div ng-switch-when="signal" class="input-field col s12"><input type="text" ng-model="parameter.value" class="validate"/><label class="active">{{parameter.name}} ({{parameter.key}})</label></div><div ng-switch-default="ng-switch-default" class="input-field col s12"><input type="text" ng-model="parameter.value" class="validate"/><label class="active">{{parameter.name}} ({{parameter.key}})</label></div></div><div class="input-field col s12"><input id="remark" type="text" ng-model="command.model.comment" class="validate"/><label for="remark" ng-class="{active: command.model.comment}">执行备注</label></div><div ng-show="command.model.password" class="input-field col s12"><input type="password" ng-model="password" class="validate"/><label ng-class="{active: password}">验证用户密码</label></div></div><div class="col s12"><div ng-show="queryToExecuting" class="btn-group"><a ng-click="doExecuteCommand(command, true)" ng-show="command.data.phase != &quot;executing&quot;" class="btn waves-effect waves-light red">确认执行控制</a><a ng-click="doCancelCommand(command ,false)" ng-show="command.data.phase == &quot;executing&quot;" class="btn waves-effect waves-light red">确认终止控制</a><a ng-click="stopQueryExecuting()" class="btn waves-effect waves-light grey">取消</a></div></div><div class="col s6"><div ng-show="commandError" class="card-panel no-padding yellow"><span class="grey-text">{{commandError}}</span></div></div></div></div><div class="modal-footer modal-nav"><nav ng-class="mvm.setting.theme"><div class="nav-wrapper"><ul><li><a href="" ng-click="doExecuteCommand(command)" title="执行控制命令" ng-show="command.data.phase != &quot;executing&quot;"><i class="material-icons left">send</i><span class="hide-on-med-and-down">执行控制</span></a><a href="" ng-click="doCancelCommand(command)" title="终止控制命令" ng-show="command.data.phase == &quot;executing&quot;"><i class="material-icons left">cancel</i><span class="hide-on-med-and-down">终止控制</span></a></li><li><a href="" data-target="command-modal" class="waves-effect waves-light modal-trigger modal-close"><i class="material-icons left">details</i><span class="hide-on-med-and-down">历史记录</span></a></li><li><a href="" ng-click="selectNextCommand()" title="选择上一控制" class="waves-effect waves-light"><i class="material-icons left">arrow_upward</i><span class="hide-on-med-and-down">上移</span></a></li><li><a href="" ng-click="selectPreviousCommand()" title="选择下一控制" class="waves-effect waves-light"><i class="material-icons left">arrow_downward</i><span class="hide-on-med-and-down">下移</span></a></li><ul class="right"><li><a href="" class="modal-action modal-close"><i class="material-icons left">close</i><span class="hide-on-med-and-down">关闭</span></a></li></ul></ul></div></nav><ul id="command-query-periods" class="dropdown-content"><li ng-repeat="type in commandManager.recordTypes"><a href="" ng-class="{active: type == commandManager.recordType}" ng-click="commandManager.selectRecordType(type); commandManager.queryRecords(command)">{{type.name}}</a></li></ul></div></div>